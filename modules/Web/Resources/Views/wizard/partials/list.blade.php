<div class="border rounded shadow-sm p-3" style="max-height: 400px; overflow-y: auto;">
    <ul class="list-unstyled mb-0">
        <li class="d-flex flex-column mb-2">
            <div class="d-flex align-items-start justify-content-between mb-3">
                <div class="d-flex align-items-start">
                    <input type="checkbox" id="academic" data-package="basic" name="module[academic]" data-num="3" class="form-check-input me-2 mt-1" value="150000">
                    <label for="item1">
                        <strong>Akademik (basic) </strong> - digunakan untuk mengelola halaman siswa
                    </label>
                </div>
                <span class="text-primary fw-bold ms-2">Rp 150.000, 00</span> 
            </div>

            <ul class="ms-4 list-unstyled">
                <li class="mb-2">
                    <div class="d-flex align-items-start justify-content-between">
                        <div class="d-flex flex-column">
                            <div class="d-flex align-items-start">
                                <input type="checkbox" data-package="basic" name="item[academic][1]" id="subitem1" class="form-check-input me-2 mt-1" value="100000">
                                <label for="subitem1">Konseling Siswa</label>
                            </div>
                            <small class="text-muted ms-4">Memberikan layanan bimbingan dan konseling untuk siswa</small>
                        </div>
                        <span class="text-primary fw-bold mt-2">Rp 100.000,00</span>
                    </div>
                </li>

                <li class="mb-2">
                    <div class="d-flex align-items-start justify-content-between">
                        <div class="d-flex flex-column">
                            <div class="d-flex align-items-start">
                                <input type="checkbox" data-package="basic" name="item[academic][2]" id="subitem2" class="form-check-input me-2 mt-1" value="50000">
                                <label for="subitem2">Aktivitas Kegiatan Siswa</label>
                            </div>
                            <small class="text-muted ms-4">Mencatat semua kegiatan ekstrakurikuler dan rutin siswa</small>
                        </div>
                        <span class="text-primary fw-bold mt-2">Rp 50.000,00</span>
                    </div>
                </li>

                <li class="mb-2">
                    <div class="d-flex align-items-start justify-content-between">
                        <div class="d-flex flex-column">
                            <div class="d-flex align-items-start">
                                <input type="checkbox" data-package="basic" id="subitem3" name="item[academic][3]" class="form-check-input me-2 mt-1" value="50000">
                                <label for="subitem4">Raport Siswa</label>
                            </div>
                            <small class="text-muted ms-4">Mencetak dan menampilkan nilai akademik siswa</small>
                        </div>
                        <span class="text-primary fw-bold mt-2">Rp 50.000,00</span>
                    </div>
                </li>
            </ul>

        </li>


        <li class="d-flex flex-column mb-3">
            <!-- Item utama -->
            <div class="d-flex align-items-start justify-content-between mb-3">
                <div class="d-flex flex-column">
                    <div class="d-flex align-items-start">
                        <input type="checkbox" data-package="basic" id="administration" name="module[administration]" data-num="5" class="form-check-input me-2 mt-1" value="450000">
                        <label for="item1">
                            <strong>Administrasi (basic)</strong> - digunakan untuk mengelola manajemen siswa
                        </label>
                    </div>
                </div>
                <span class="text-primary fw-bold ms-2">Rp 450.000,00</span>
            </div>

            <!-- Sub-items -->
            <ul class="ms-4 list-unstyled">
                <li class="d-flex align-items-start justify-content-between mb-2">
                    <div class="d-flex flex-column">
                        <div class="d-flex align-items-start">
                            <input type="checkbox" data-package="basic" id="subitem2" name="item[administration][1]" class="form-check-input me-2 mt-1" value="100000">
                            <label for="subitem2">Kesiswaan</label>
                        </div>
                        <small class="text-muted ms-4">Pengelolaan siswa dan registrasi per semester berdasarkan kelas</small>
                    </div>
                    <span class="text-primary fw-bold mt-2">Rp 100.000,00</span>
                </li>

                <li class="d-flex align-items-start justify-content-between mb-2">
                    <div class="d-flex flex-column">
                        <div class="d-flex align-items-start">
                            <input type="checkbox" data-package="basic" id="subitem1" name="item[administration][2]" class="form-check-input me-2 mt-1" value="100000">
                            <label for="subitem1">Mata Pelajaran dan Pertemuan</label>
                        </div>
                        <small class="text-muted ms-4">Pengelolaan pertemuan siswa dan penambahan mata pelajaran</small>
                    </div>
                    <span class="text-primary fw-bold mt-2">Rp 100.000,00</span>
                </li>

                <li class="d-flex align-items-start justify-content-between mb-2">
                    <div class="d-flex flex-column">
                        <div class="d-flex align-items-start">
                            <input type="checkbox" data-package="basic" id="subitem2" name="item[administration][3]" class="form-check-input me-2 mt-1" value="100000">
                            <label for="subitem2">Ruangan dan Fasilitas</label>
                        </div>
                        <small class="text-muted ms-4">Pengelolaan ruangan dan fasilitas berdasarkan putra dan putri</small>
                    </div>
                    <span class="text-primary fw-bold mt-2">Rp 100.000,00</span>
                </li>

                <li class="d-flex align-items-start justify-content-between mb-2">
                    <div class="d-flex flex-column">
                        <div class="d-flex align-items-start">
                            <input type="checkbox" data-package="basic" id="subitem2" name="item[administration][4]" class="form-check-input me-2 mt-1" value="100000">
                            <label for="subitem2">Tagihan Siswa</label>
                        </div>
                        <small class="text-muted ms-4">Pengelolaan tagihan berdasarkan keseluruhan siswa dan per kelas</small>
                    </div>
                    <span class="text-primary fw-bold mt-2">Rp 100.000,00</span>
                </li>

                <li class="d-flex align-items-start justify-content-between mb-2">
                    <div class="d-flex flex-column">
                        <div class="d-flex align-items-start">
                            <input type="checkbox" data-package="basic" id="subitem2" name="item[administration][5]" class="form-check-input me-2 mt-1" value="100000">
                            <label for="subitem2">Referensi Pembayaran</label>
                        </div>
                        <small class="text-muted ms-4">Pengelolaan pembayaran PSB setiap gelombang pendaftaran</small>
                    </div>
                    <span class="text-primary fw-bold mt-2">Rp 100.000,00</span>
                </li>

            </ul>
        </li>

        <li class="d-flex flex-column mb-3">
            
            <div class="d-flex align-items-start justify-content-between mb-1">
                <div class="d-flex flex-column">
                    <div class="d-flex align-items-start">
                        <input type="checkbox" data-package="basic" id="teacher" name="module[teacher]" data-num="3" class="form-check-input me-2 mt-1 mb-3" value="200000">
                        <label for="item1">
                            <strong>Pengajaran (Basic)</strong> - digunakan untuk manajemen pembelajaran siswa
                        </label>
                    </div>
                </div>
                <span class="text-primary fw-bold ms-2">Rp 200.000,00</span>
            </div>

            <!-- Sub-items -->
            <ul class="ms-4 list-unstyled">
                <li class="d-flex align-items-start justify-content-between mb-2">
                    <div class="d-flex flex-column">
                        <div class="d-flex align-items-start">
                            <input type="checkbox" data-package="basic" id="subitem1" name="item[teacher][1]" class="form-check-input me-2 mt-1" value="50000">
                            <label for="subitem1">Kegiatan Siswa</label>
                        </div>
                        <small class="text-muted ms-4">Pengelolaan Eksul siswa dan prestasi berdasarkan semester berjalan</small>
                    </div>
                    <span class="text-primary fw-bold mt-2">Rp 50.000,00</span>
                </li>

                <li class="d-flex align-items-start justify-content-between mb-2">
                    <div class="d-flex flex-column">
                        <div class="d-flex align-items-start">
                            <input type="checkbox" data-package="basic" id="subitem2" name="item[teacher][2]" class="form-check-input me-2 mt-1" value="100000">
                            <label for="subitem2">Manajemen Pembelajaran</label>
                        </div>
                        <small class="text-muted ms-4">Pengelolaan pertemuan dan rencana pembelajaran siswa</small>
                    </div>
                    <span class="text-primary fw-bold mt-2">Rp 100.000,00</span>
                </li>

                <li class="d-flex align-items-start justify-content-between mb-2">
                    <div class="d-flex flex-column">
                        <div class="d-flex align-items-start">
                            <input type="checkbox" data-package="basic" id="subitem2" name="item[teacher][3]" class="form-check-input me-2 mt-1" value="100000">
                            <label for="subitem2">Rapot</label>
                        </div>
                        <small class="text-muted ms-4">Perhitungan nilai siswa berdasarkan semster</small>
                    </div>
                    <span class="text-primary fw-bold mt-2">Rp 100.000,00</span>
                </li>
            </ul>
        </li>

        <li class="d-flex flex-column mb-3">
            
            <div class="d-flex align-items-start justify-content-between mb-1">
                <div class="d-flex flex-column">
                    <div class="d-flex align-items-start">
                        <input type="checkbox" data-package="basic" id="hrms" name="module[hrms]" data-num="5" class="form-check-input me-2 mt-1 mb-3" value="950000">
                        <label for="item1">
                            <strong>HRMS (Basic)</strong> - Manajemen SDM karyawan dan guru.
                        </label>
                    </div>
                </div>
                <span class="text-primary fw-bold ms-2">Rp 950.000,00</span>
            </div>

            <!-- Sub-items -->
            <ul class="ms-4 list-unstyled">

                <li class="d-flex align-items-start justify-content-between mb-2">
                    <div class="d-flex flex-column">
                        <div class="d-flex align-items-start">
                            <input type="checkbox" data-package="basic" id="subitem1" name="item[hrms][1]" class="form-check-input me-2 mt-1" value="200000">
                            <label for="subitem1">Data Karyawan</label>
                        </div>
                        <small class="text-muted ms-4">Penambahan, penghapusan karyawan dan perjanjian kerja</small>
                    </div>
                    <span class="text-primary fw-bold mt-2">Rp 200.000,00</span>
                </li>

                <li class="d-flex align-items-start justify-content-between mb-2">
                    <div class="d-flex flex-column">
                        <div class="d-flex align-items-start">
                            <input type="checkbox" data-package="basic" id="subitem1" name="item[hrms][2]" class="form-check-input me-2 mt-1" value="200000">
                            <label for="subitem1">Pengajaran Guru</label>
                        </div>
                        <small class="text-muted ms-4">Pengelolaan pengajaran guru berdasarkan shift dan mapel</small>
                    </div>
                    <span class="text-primary fw-bold mt-2">Rp 200.000,00</span>
                </li>

                <li class="d-flex align-items-start justify-content-between mb-2">
                    <div class="d-flex flex-column">
                        <div class="d-flex align-items-start">
                            <input type="checkbox" data-package="basic" id="subitem1" name="item[hrms][3]" class="form-check-input me-2 mt-1" value="200000">
                            <label for="subitem1">Petugas Piket</label>
                        </div>
                        <small class="text-muted ms-4">Penambahan jadwal piket pada guru</small>
                    </div>
                    <span class="text-primary fw-bold mt-2">Rp 200.000,00</span>
                </li>

                <li class="d-flex align-items-start justify-content-between mb-2">
                    <div class="d-flex flex-column">
                        <div class="d-flex align-items-start">
                            <input type="checkbox" data-package="basic" id="subitem1" name="item[hrms][4]" class="form-check-input me-2 mt-1" value="200000">
                            <label for="subitem1">Manajemen karyawan</label>
                        </div>
                        <small class="text-muted ms-4">Pengelolaan jadwal kerja, absensi, izin, cuti</small>
                    </div>
                    <span class="text-primary fw-bold mt-2">Rp 200.000,00</span>
                </li>

                <li class="d-flex align-items-start justify-content-between mb-2">
                    <div class="d-flex flex-column">
                        <div class="d-flex align-items-start">
                            <input type="checkbox" data-package="basic" id="subitem1" name="item[hrms][5]" class="form-check-input me-2 mt-1" value="200000">
                            <label for="subitem1">Rekap karyawan dan pengajaran</label>
                        </div>
                        <small class="text-muted ms-4">Rekapitulasi karyawan dan pengajaran guru</small>
                    </div>
                    <span class="text-primary fw-bold mt-2">Rp 200.000,00</span>
                </li>
                
                
            </ul>
        </li>


        <!-- board -->
        <li class="d-flex flex-column mb-3">
            
            <div class="d-flex align-items-start justify-content-between mb-1">
                <div class="d-flex flex-column">
                    <div class="d-flex align-items-start">
                        <input type="checkbox" data-package="advanced" id="board" data-num="2" name="module[board]" class="form-check-input me-2 mt-1 mb-3" value="150000">
                        <label for="item1">
                            <strong>Pondok (Advanced)</strong> - digunakan untuk menejemen pondok
                        </label>
                    </div>
                </div>
                <span class="text-primary fw-bold ms-2">Rp 150.000,00</span>
            </div>

            <!-- Sub-items -->
            <ul class="ms-4 list-unstyled">
                <li class="d-flex align-items-start justify-content-between mb-2">
                    <div class="d-flex flex-column">
                        <div class="d-flex align-items-start">
                            <input type="checkbox" data-package="advanced" name="item[board][1]" id="subitem1" class="form-check-input me-2 mt-1" value="100000">
                            <label for="subitem1">Pengololaan Mata pelajaran</label>
                        </div>
                        <small class="text-muted ms-4">Pengelolaan pertemuan siswa dan penmabahan mata pelajaran</small>
                    </div>
                    <span class="text-primary fw-bold mt-2">Rp 100.000,00</span>
                </li>

                <li class="d-flex align-items-start justify-content-between mb-2">
                    <div class="d-flex flex-column">
                        <div class="d-flex align-items-start">
                            <input type="checkbox" data-package="advanced" name="item[board][2]" id="subitem2" class="form-check-input me-2 mt-1" value="100000">
                            <label for="subitem2">Pertemuan Pembelajaran Siswa</label>
                        </div>
                        <small class="text-muted ms-4">Pengelolaan mata pembelajaran antara guru dan siswa</small>
                    </div>
                    <span class="text-primary fw-bold mt-2">Rp 100.000,00</span>
                </li>
            </ul>
        </li>


        <!-- konseling -->
        <li class="d-flex flex-column mb-3">
            
            <div class="d-flex align-items-start justify-content-between mb-1">
                <div class="d-flex flex-column">
                    <div class="d-flex align-items-start">
                        <input type="checkbox" data-package="advanced" id="counseling" name="module[counseling]" data-num="2" class="form-check-input me-2 mt-1 mb-3" value="150000">
                        <label for="item1">
                            <strong>Konseling (Advanced)</strong> - digunakan untuk konseling siswa
                        </label>
                    </div>
                </div>
                <span class="text-primary fw-bold ms-2">Rp 150.000,00</span>
            </div>

            <!-- Sub-items -->
            <ul class="ms-4 list-unstyled">
                <li class="d-flex align-items-start justify-content-between mb-2">
                    <div class="d-flex flex-column">
                        <div class="d-flex align-items-start">
                            <input type="checkbox" data-package="advanced" name="item[counseling][1]" id="subitem1" class="form-check-input me-2 mt-1" value="100000">
                            <label for="subitem1">Presensi</label>
                        </div>
                        <small class="text-muted ms-4">Digunakan untuk presensi siswa per kelas</small>
                    </div>
                    <span class="text-primary fw-bold mt-2">Rp 100.000,00</span>
                </li>

                <li class="d-flex align-items-start justify-content-between mb-2">
                    <div class="d-flex flex-column">
                        <div class="d-flex align-items-start">
                            <input type="checkbox" data-package="advanced" id="subitem2" name="item[counseling][2]" class="form-check-input me-2 mt-1" value="100000">
                            <label for="subitem2">Manejemen konseling Siswa</label>
                        </div>
                        <small class="text-muted ms-4">Bimbingan konseling, pendampingan akademik, dan masalah pribadi siswa</small>
                    </div>
                    <span class="text-primary fw-bold mt-2">Rp 100.000,00</span>
                </li>
            </ul>
        </li>

        <li class="d-flex flex-column mb-3">
            
            <div class="d-flex align-items-start justify-content-between mb-1">
                <div class="d-flex flex-column">
                    <div class="d-flex align-items-start">
                        <input type="checkbox" data-package="advanced" id="finance" name="module[finance]" data-num="2" class="form-check-input me-2 mt-1 mb-3" value="300000">
                        <label for="item1">
                            <strong>Keuangan (Advanced)</strong> - Mengelola manajemen operasional karyawan dan guru.
                        </label>
                    </div>
                </div>
                <span class="text-primary fw-bold ms-2">Rp 300.000,00</span>
            </div>

            <!-- Sub-items -->
            <ul class="ms-4 list-unstyled">
                <li class="d-flex align-items-start justify-content-between mb-2">
                    <div class="d-flex flex-column">
                        <div class="d-flex align-items-start">
                            <input type="checkbox" data-package="advanced" id="subitem1" name="item[finance][1]" class="form-check-input me-2 mt-1" value="100000">
                            <label for="subitem1">Rekap</label>
                        </div>
                        <small class="text-muted ms-4">terdapat rekap cuti, izin, kegiatan, penggajian guru dan karyawan</small>
                    </div>
                    <span class="text-primary fw-bold mt-2">Rp 100.000,00</span>
                </li>

                <li class="d-flex align-items-start justify-content-between mb-2">
                    <div class="d-flex flex-column">
                        <div class="d-flex align-items-start">
                            <input type="checkbox" data-package="advanced" id="subitem1" name="item[finance][2]" class="form-check-input me-2 mt-1" value="250000">
                            <label for="subitem1">Penggajian Guru dan Karyawan</label>
                        </div>
                        <small class="text-muted ms-4">penggajian otomatis termasuk penghitungan PPH 21</small>
                    </div>
                    <span class="text-primary fw-bold mt-2">Rp 250.000,00</span>
                </li>
                
            </ul>
        </li>

        <li class="d-flex flex-column mb-3">
            
            <div class="d-flex align-items-start justify-content-between mb-1">
                <div class="d-flex flex-column">
                    <div class="d-flex align-items-start">
                        <input type="checkbox" data-package="extra" name="module[pos]" id="pos" data-num="5" class="form-check-input me-2 mt-1 mb-3" value="600000">
                        <label for="item1">
                            <strong>POS (Extra)</strong> - Manajemen unit usaha sekolah.
                        </label>
                    </div>
                </div>
                <span class="text-primary fw-bold ms-2">Rp 600.000,00</span>
            </div>

            <!-- Sub-items -->
            <ul class="ms-4 list-unstyled">

                <li class="d-flex align-items-start justify-content-between mb-2">
                    <div class="d-flex flex-column">
                        <div class="d-flex align-items-start">
                            <input type="checkbox" data-package="extra" id="subitem1" name="item[pos][1]" class="form-check-input me-2 mt-1" value="200000">
                            <label for="subitem1">Produk</label>
                        </div>
                        <small class="text-muted ms-4">Pengelolaan produk toko</small>
                    </div>
                    <span class="text-primary fw-bold mt-2">Rp 200.000,00</span>
                </li>

                <li class="d-flex align-items-start justify-content-between mb-2">
                    <div class="d-flex flex-column">
                        <div class="d-flex align-items-start">
                            <input type="checkbox" data-package="extra" id="subitem1" name="item[pos][2]" class="form-check-input me-2 mt-1" value="200000">
                            <label for="subitem1">Supplier</label>
                        </div>
                        <small class="text-muted ms-4">Pengelolaan jadwal per shift dan barang dari supplier</small>
                    </div>
                    <span class="text-primary fw-bold mt-2">Rp 200.000,00</span>
                </li>

                <li class="d-flex align-items-start justify-content-between mb-2">
                    <div class="d-flex flex-column">
                        <div class="d-flex align-items-start">
                            <input type="checkbox" data-package="extra" id="subitem1" name="item[pos][3]" class="form-check-input me-2 mt-1" value="200000">
                            <label for="subitem1">Sistem penjualan</label>
                        </div>
                        <small class="text-muted ms-4">Pengelolaan POS berisi antrian atau penjualan langsung</small>
                    </div>
                    <span class="text-primary fw-bold mt-2">Rp 200.000,00</span>
                </li>

                <li class="d-flex align-items-start justify-content-between mb-2">
                    <div class="d-flex flex-column">
                        <div class="d-flex align-items-start">
                            <input type="checkbox" data-package="extra" id="subitem1" name="item[pos][4]" class="form-check-input me-2 mt-1" value="100000">
                            <label for="subitem1">Laporan</label>
                        </div>
                        <small class="text-muted ms-4">Laporan POS hari ini, bulanan, tahunan</small>
                    </div>
                    <span class="text-primary fw-bold mt-2">Rp 100.000,00</span>
                </li>

                <li class="d-flex align-items-start justify-content-between mb-2">
                    <div class="d-flex flex-column">
                        <div class="d-flex align-items-start">
                            <input type="checkbox" data-package="extra" id="subitem1" name="item[pos][5]" class="form-check-input me-2 mt-1" value="150000">
                            <label for="subitem1">Manajemen Stock</label>
                        </div>
                        <small class="text-muted ms-4">Penambahan dan penguran stock dengan sistem adjustment</small>
                    </div>
                    <span class="text-primary fw-bold mt-2">Rp 150.000,00</span>
                </li>
                
                
            </ul>
        </li>

    </ul>
</div>

<textarea hidden id="data_json" name="data_json">

</textarea>

<div class="mt-3">
    <strong>Grand Total: Rp <span id="total">0</span></strong>
</div>

@push('scripts')
<script>
document.addEventListener("DOMContentLoaded", function () {
document.querySelectorAll('input[type=checkbox][data-num]').forEach(parentCheckbox => {
    let group = parentCheckbox.id;
    let numRequired = parseInt(parentCheckbox.dataset.num);

    // Klik parent → toggle semua child
    parentCheckbox.addEventListener('change', function() {
        let subCheckboxes = document.querySelectorAll(`input[name^="item[${group}]"]`);
        subCheckboxes.forEach(cb => cb.checked = this.checked);
    });

    // Klik child → update parent
    document.querySelectorAll(`input[name^="item[${group}]"]`).forEach(child => {
        child.addEventListener('change', function() {
            let subCheckboxes = document.querySelectorAll(`input[name^="item[${group}]"]`);
            let checkedCount = [...subCheckboxes].filter(cb => cb.checked).length;

            if (checkedCount === numRequired) {
                parentCheckbox.checked = true;   // semua dicentang
            } else {
                parentCheckbox.checked = false;  // kalau kurang → hilang centang
            }
        });
    });
});

function updateTotalAndSave() {
        let total = 0;
        let data = {};

        document.querySelectorAll('input[type=checkbox][data-num]').forEach(parentCheckbox => {
            let group = parentCheckbox.id;
            let numRequired = parseInt(parentCheckbox.dataset.num);
            let subCheckboxes = document.querySelectorAll(`input[name^="item[${group}]"]`);
            let checkedCount = [...subCheckboxes].filter(cb => cb.checked).length;

            let parentStatus = (checkedCount === numRequired);

            data[group] = {
                parent: parentStatus,
                value: parseInt(parentCheckbox.value || 0),
                items: []
            };

            subCheckboxes.forEach((cb, idx) => {
                data[group].items.push({
                    index: idx + 1,
                    value: parseInt(cb.value || 0),
                    checked: cb.checked
                });
            });

            if (parentStatus) {
                total += parseInt(parentCheckbox.value || 0);
            } else {
                subCheckboxes.forEach(cb => {
                    if (cb.checked) total += parseInt(cb.value || 0);
                });
            }

            parentCheckbox.checked = parentStatus;
        });

        document.getElementById('total').textContent = total.toLocaleString("id-ID");
        document.getElementById('data_json').value = JSON.stringify(data, null, 2);
    }

    document.querySelectorAll('input[type=checkbox]').forEach(cb => {
        cb.addEventListener('change', updateTotalAndSave);
    });

     document.querySelectorAll('input[type=checkbox][data-package="basic"]').forEach(parentCheckbox => {
        let group = parentCheckbox.id;

        parentCheckbox.checked = true;
        document.querySelectorAll(`input[name^="item[${group}]"]`).forEach(cb => {
            cb.checked = true;
        });
    });


    updateTotalAndSave();
});
</script>

@endpush